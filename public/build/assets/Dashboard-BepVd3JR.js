import{c as u,b as t,e as r,r as f,o as T,a as B,j as D,k as g,l as a,x as l,q as b,u as n,T as U,p as _,F as P,y as O,I as q,f as N}from"./app-sYwY5Q9E.js";import{_ as V}from"./DisplayLayout-BWhLaTvW.js";import{_ as H}from"./LoadingOverlay-Dr_9UgDn.js";import{g as z,S as F,r as Z,M as R,b as S,a as W,c as Y,d as J,e as K,f as Q}from"./UsersIcon-DqtmiJJl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function X(p,v){return r(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z","clip-rule":"evenodd"})])}const tt={class:"dashboard-fit-container relative"},et={class:"header-section"},st={class:"text-xl font-bold text-blue-900"},at={class:"text-sm text-gray-500"},lt={class:"header-actions flex items-center gap-4"},nt={class:"px-1 py-1"},ot={class:"px-1 py-1"},it={class:"px-1 py-1"},dt={class:"grid grid-cols-1 md:grid-cols-3 gap-6 flex-shrink-0"},rt={class:"bg-blue-50 border-l-8 border-blue-500 p-6 rounded-xl shadow-sm hover:shadow-md transition"},ct={class:"flex flex-col h-full justify-between"},ut={class:"mb-2"},vt={class:"text-5xl font-extrabold text-blue-900"},gt={class:"bg-green-50 border-l-8 border-green-500 p-6 rounded-xl shadow-sm hover:shadow-md transition"},ft={class:"flex flex-col h-full justify-between"},pt={class:"mb-2"},mt={class:"text-5xl font-extrabold text-green-800"},bt={class:"bg-orange-50 border-l-8 border-orange-400 p-6 rounded-xl shadow-sm hover:shadow-md transition"},xt={class:"flex flex-col h-full justify-between"},_t={class:"mb-2"},ht={class:"text-5xl font-extrabold text-orange-600"},yt={class:"workspace"},wt={class:"panel serving-panel"},kt={class:"serving-body"},Lt={key:0,class:"w-full flex flex-col items-center gap-4"},St={class:"ticket-display animate-pop"},It={class:"guest-info"},qt={class:"info-col"},Nt={class:"info-col border-x"},$t={class:"info-col"},jt={key:1,class:"empty-serving"},At={class:"control-buttons"},Ct=["disabled"],Mt=["disabled"],Et=["disabled"],Gt=["disabled"],Tt={key:0},Bt={key:1},Dt={class:"panel list-panel"},Ut={class:"panel-title text-left pl-4 border-b flex justify-between pr-4"},Pt={class:"bg-orange-100 text-orange-600 px-2 rounded text-xs py-1"},Ot={class:"list-scroll"},Vt={key:0,class:"queue-list"},Ht={class:"q-header"},zt={class:"q-number"},Ft={class:"q-service"},Zt={class:"q-body"},Rt={class:"q-name"},Wt={class:"q-id"},Yt={key:1,class:"empty-state"},ee={__name:"Dashboard",props:{counter:Object,currentServing:Object,waitingList:Array,stats:Object,auth:Object},setup(p){const v=p,s=f(v.currentServing),m=f(v.waitingList||[]),h=f(v.stats||{total:0,finished:0}),c=f(!1),y=f(v.waitingList?v.waitingList.length:0);let w=null;const k=async()=>{try{const d=new Date().getTime(),e=`/staff/${v.counter.id}/stats?t=${d}`,o=await q.get(e);s.value=o.data.currentServing,o.data.waitingList?(m.value=o.data.waitingList,y.value=o.data.waitingList.length):(m.value=[],y.value=0),o.data.stats&&(h.value=o.data.stats)}catch(d){console.error("Gagal polling data",d)}};T(()=>{k(),w=setInterval(k,3e3)}),B(()=>{w&&clearInterval(w)});const x=async(d,e={})=>{if(!c.value){c.value=!0;try{await q.post(d,{...e,counter_id:v.counter.id}),await k()}catch(o){console.error("Gagal aksi:",o)}finally{c.value=!1}}},$=()=>x("/staff/call-next"),j=()=>x("/staff/recall"),A=()=>{if(!s.value)return;const d=s.value.id;s.value=null,x("/staff/skip",{queue_id:d})},C=()=>{if(!s.value)return;const d=s.value.id;s.value=null,x("/staff/complete",{queue_id:d})},L=f(!1);document.addEventListener("inertia:start",()=>L.value=!0),document.addEventListener("inertia:finish",()=>L.value=!1);const M=()=>N.get("/staff"),E=()=>N.post("/logout");return(d,e)=>(r(),D(V,{title:`Loket ${p.counter.name}`},{default:g(()=>{var o,I;return[a(H,{show:c.value||L.value,message:"Memproses aksi..."},null,8,["show"]),t("div",tt,[t("section",et,[t("div",null,[t("h2",st,"Halo, "+l((I=(o=p.auth)==null?void 0:o.user)==null?void 0:I.name),1),t("p",at,[e[0]||(e[0]=b("Bertugas di: ",-1)),t("strong",null,l(p.counter.name),1)])]),t("div",lt,[e[5]||(e[5]=t("div",{class:"live-indicator"},[t("span",{class:"dot"}),b(" Live ")],-1)),a(n(z),{as:"div",class:"relative inline-block text-left z-50"},{default:g(()=>[t("div",null,[a(n(F),{class:"inline-flex justify-center rounded-lg bg-blue-900 px-3 py-2 text-sm font-medium text-white hover:bg-blue-800 focus:outline-none shadow-md items-center gap-2 border border-blue-700 transition active:scale-95"},{default:g(()=>[e[1]||(e[1]=t("span",{class:"hidden md:inline"},"Menu Staff",-1)),a(n(Z),{class:"h-6 w-6","aria-hidden":"true"})]),_:1})]),a(U,{"enter-active-class":"transition duration-100 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-75 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:g(()=>[a(n(R),{class:"absolute right-0 mt-2 w-56 origin-top-right divide-y divide-gray-100 rounded-md bg-white shadow-xl ring-1 ring-black/5 focus:outline-none border border-gray-100"},{default:g(()=>[t("div",nt,[a(n(S),null,{default:g(({active:i})=>[t("button",{onClick:M,class:_([i?"bg-blue-50 text-blue-900":"text-gray-900","group flex w-full items-center rounded-md px-2 py-2 text-sm font-bold"])},[a(n(X),{class:"mr-2 h-5 w-5 text-blue-600","aria-hidden":"true"}),e[2]||(e[2]=b(" Ganti Loket ",-1))],2)]),_:1})]),t("div",ot,[a(n(S),null,{default:g(({active:i})=>[t("a",{href:"/admin/export",target:"_blank",class:_([i?"bg-yellow-50 text-yellow-900":"text-gray-900","group flex w-full items-center rounded-md px-2 py-2 text-sm font-bold"])},[a(n(W),{class:"mr-2 h-5 w-5 text-yellow-600","aria-hidden":"true"}),e[3]||(e[3]=b(" Export Excel Harian ",-1))],2)]),_:1})]),t("div",it,[a(n(S),null,{default:g(({active:i})=>[t("button",{onClick:E,class:_([i?"bg-red-50 text-red-900":"text-gray-900","group flex w-full items-center rounded-md px-2 py-2 text-sm font-bold text-red-600"])},[a(n(Y),{class:"mr-2 h-5 w-5 text-red-600","aria-hidden":"true"}),e[4]||(e[4]=b(" Logout ",-1))],2)]),_:1})])]),_:1})]),_:1})]),_:1})])]),t("section",dt,[t("div",rt,[t("div",ct,[t("div",ut,[a(n(J),{class:"w-12 h-12 text-blue-900"})]),t("div",null,[t("div",vt,l(h.value.total),1),e[6]||(e[6]=t("div",{class:"text-sm font-bold text-gray-600 mt-1"},"Total Antrian",-1))])])]),t("div",gt,[t("div",ft,[t("div",pt,[a(n(K),{class:"w-12 h-12 text-green-800"})]),t("div",null,[t("div",mt,l(h.value.finished),1),e[7]||(e[7]=t("div",{class:"text-sm font-bold text-gray-600 mt-1"},"Selesai",-1))])])]),t("div",bt,[t("div",xt,[t("div",_t,[a(n(Q),{class:"w-12 h-12 text-orange-600"})]),t("div",null,[t("div",ht,l(y.value),1),e[8]||(e[8]=t("div",{class:"text-sm font-bold text-gray-600 mt-1"},"Menunggu",-1))])])])]),t("section",yt,[t("div",wt,[e[14]||(e[14]=t("div",{class:"panel-title"},"SEDANG MELAYANI",-1)),t("div",kt,[s.value?(r(),u("div",Lt,[t("div",St,l(s.value.ticket_code),1),e[12]||(e[12]=t("span",{class:"status-badge active"},"STATUS: DIPANGGIL",-1)),t("div",It,[t("div",qt,[e[9]||(e[9]=t("small",null,"Nama",-1)),t("p",null,l(s.value.guest_name),1)]),t("div",Nt,[e[10]||(e[10]=t("small",null,"NRP / ID",-1)),t("p",null,l(s.value.identity_number),1)]),t("div",$t,[e[11]||(e[11]=t("small",null,"Perihal",-1)),t("p",null,l(s.value.purpose),1)])])])):(r(),u("div",jt,[...e[13]||(e[13]=[t("div",{class:"ticket-placeholder"},"---",-1),t("span",{class:"status-badge idle"},"MENUNGGU",-1),t("p",{class:"text-sm text-gray-400 mt-2"},"Silakan panggil antrian berikutnya",-1)])])),t("div",At,[t("button",{class:"btn-ctrl success",disabled:!s.value||c.value,onClick:C}," âœ” Selesai ",8,Ct),t("button",{class:"btn-ctrl danger",disabled:!s.value||c.value,onClick:A}," ðŸš« Lewati ",8,Mt),t("button",{class:"btn-ctrl warning",disabled:!s.value||c.value,onClick:j}," ðŸ”” Panggil Ulang ",8,Et),t("button",{class:"btn-ctrl primary",disabled:c.value,onClick:$},[c.value?(r(),u("span",Tt,"â³...")):(r(),u("span",Bt,"â–¶ Panggil Berikutnya"))],8,Gt)])])]),t("div",Dt,[t("div",Ut,[e[15]||(e[15]=t("span",null,"ðŸ‘¤ Antrian Menunggu",-1)),t("span",Pt,l(m.value.length),1)]),t("div",Ot,[m.value.length>0?(r(),u("div",Vt,[(r(!0),u(P,null,O(m.value,(i,G)=>(r(),u("div",{key:i.id,class:_(["queue-card",{"top-card":G===0}])},[t("div",Ht,[t("span",zt,l(i.ticket_code),1),t("span",Ft,l(i.purpose||"Umum"),1)]),t("div",Zt,[t("p",Rt,l(i.guest_name),1),t("p",Wt,"ID: "+l(i.identity_number),1)])],2))),128))])):(r(),u("div",Yt,[...e[16]||(e[16]=[t("div",{class:"text-4xl mb-2"},"â˜•",-1),t("p",null,"Tidak ada antrian menunggu",-1)])]))])])])])]}),_:1},8,["title"]))}};export{ee as default};
